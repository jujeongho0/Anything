# 2021-1 아주대 파란학기(ajou_Paran)


**팀명** : Anything

**도전 과제명** : 가구산업 텍스트, 이미지 복합 검색 시스템 연구 및 개발

**도전 목표** : 사용자가 텍스트와 이미지를 복합적으로 이용해 특정 패턴이 있는 가구를 검색할 수 있는 검색 엔진 개발

**개요** : 
1. 사용자가 텍스트와 패턴 이미지 입력
2-1. 사용자가 입력한 텍스트는 tensorflow의 Bidirectional GRU를 이용해 학습한 NLP 모델을 통해 22개의 가구 카테고리 중 가장 유사한 가구로 분류
2-2. sklearn.neighbors.KNeighborsClassifier()를 통해 사용자가 입력한 패턴 이미지(GoogleNet 모델을 transfer learning한 CNN 모델로 feature 추출)와 기존에 가지고 있는 4000여장의 패턴 이미지 feature 중 유사한 패턴 이미지 4개 추출
3. yolov5와 cv2.grabCut()을 이용해 2-1에서 분류된 가구의 이미지에서 배경 제거
4. ORB 기술과 BFMatcher를 이용해 "사용자가 입력한 패턴 이미지 + 2-2에서 추출한 4개의 유사 패턴"과 "3에서 배경이 제거된 가구 이미지"에서 다수의 비슷한 벡터가 추출된다면 해당 패턴을 가지고 있는 가구로 판단하여 추출
5. 최종적으로, 4에서 추출한 가구 이미지들을 최종 검색 결과물로 보여줌
6. Django를 이용해 위 과정을 웹으로 구현
7. 웹 호스팅 서비스 Pythonanywhere를 이용해 서버 배포

**22개의 가구 카테고리** :
```
  '가죽소파', '소파베드', 
  '더블/퀸/킹침대', '싱글/수퍼싱글+침대', '디반침대', 
  '옷장', '어린이옷장', 
  '바테이블', '커피테이블/보조테이블', '식탁',  
  '식탁의자', '바의자', '사무용의자', '스툴/벤치', '어린이의자', '영아용의자', '가죽암체어', '라탄암체어', '리클라이너', 
  '커튼', '샤워커튼', '블라인드'
```

---
   
## NLP를 이용해 가구 분류 모델 구현(NLP_BiGRU)

- 개요
  + 22종의 가구를 분류하는 인공지능 모델
  + 학습 데이터는 IKEA에서 웹 크롤링한 텍스트 데이터
  + Bidirectional GRU 알고리즘 이용

- 구현 사항
  + okt 형태소 분석기를 이용해 텍스트 데이터 토큰화
  + 단어의 빈도수를 이용해 텍스트 데이터 정수 인코딩
  + 텍스트 데이터 중 최장 길이로 패딩
  + 위 과정을 거쳐 전처리된 텍스트 데이터를 Embedding()을 이용해 단어 임베딩
  + Bidirectional GRU를 이용해 인공지능 모델 학습 및 검증
  + 구현한 NLP 모델을 'anythingNLP.h5'로 저장

- 검증 정확도
```
  ...중략...
  Epoch 00020: val_acc did not improve from 0.99342
```

---

